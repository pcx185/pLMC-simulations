%======================================================================
%Here is the data for 'plmc50d.m'
%======================================================================
Dtvals = [2^-9, 2^-8, 2^-7, 2^-6, 2^-5];
%======================================================================

%error1: indicator function
%======================================================================
%seed=100 [0.0130000000000000,0.0280000000000000,0.0660000000000000,0.158000000000000,0.319000000000000];
%seed=200 [0.00800000000000000,0.0230000000000000,0.0640000000000000,0.151000000000000,0.316000000000000]
%seed=300 [0.0150000000000000,0.0300000000000000,0.0850000000000000,0.167000000000000,0.308000000000000]
error1= [0.012000000000000 ,  0.027000000000000 ,  0.071666666666667  , 0.158666666666667  , 0.314333333333333];

%======================================================================
%error2: \exp function
%======================================================================

%seed=100 [0.000592341630447334,0.00151141785216448,0.00342227639601076,0.00728477736501381,0.0172846049079043];
%seed=200 [0.000530991675125243,0.00133412834436124,0.00299414813395913,0.00685950849195590,0.0167066366388415]
%seed=300 [0.000563166346705767,0.00139115899817390,0.00309682415388823,0.00650854383349891,0.0168865638327079]
error2=[ 0.000562166550759,   0.001412235064900,   0.003171082894619 ,  0.006884276563490 ,  0.016959268459818];

%======================================================================
%error3: step function
%======================================================================

%seed=100 [0.0162500000000000,0.0352500000000000,0.0825000000000000,0.198250000000000,0.408000000000000];
%seed=200 [0.0100000000000000,0.0287500000000000,0.0800000000000000,0.189000000000000,0.404250000000000]
%seed=300 [0.0187500000000000,0.0375000000000000,0.106500000000000,0.209250000000000,0.392000000000000]
error3=[ 0.015000000000000  , 0.033833333333333 ,  0.089666666666667  , 0.198833333333333 ,  0.401416666666667];

%======================================================================
%error4: \arctan function
%======================================================================

%seed=100 [0.000869588349421272,0.00221934065645750,0.00503347378090824,0.0107705808817335,0.0258548907543942];
%seed=200 [0.000781259029142388,0.00196070515640043,0.00440466033972348,0.0101299480727603,0.0249600613456938]
%seed=300 [0.000827703064913308,0.00204629761866484,0.00455859311586321,0.00962281430776947,0.0252235855064873]
error4=[0.000826183481159,   0.002075447810508 ,  0.004665575745498 ,  0.010174447754088 ,  0.025346179202192];

loglog(Dtvals,error1,'b-^','LineWidth' ,1.5 , 'MarkerSize',5);
hold on;
loglog(Dtvals,error2,'g-o','LineWidth' ,1.5 , 'MarkerSize',5);
hold on;
loglog(Dtvals,error3,'c-p','LineWidth' ,1.5 , 'MarkerSize',5);
hold on;
loglog(Dtvals,error4,'m-d','LineWidth' ,1.5 , 'MarkerSize',5);
hold on;
loglog(Dtvals,0.08*(Dtvals),'r-.h','LineWidth' ,1.5);
hold on;
loglog(Dtvals,9*(sqrt(Dtvals)),'k-+','LineWidth' ,1.5);
hold on;
axis([1e-3 1e-1 1e-5 1e1]);
legend('\phi(x)=indicator function', '\phi(x)=exp(-||x||)','\phi(x)=ladder function','\phi(x)=arctan(||x||)','order 1.0','order 0.5', 'location','SouthEast');
xlabel('Stepsizes')
ylabel('Weak errors')
title('Weak convergence rate of the projected Langevin Monte Carlo algorithm (d=50)','FontSize',10);