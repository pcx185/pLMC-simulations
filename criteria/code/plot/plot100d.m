%======================================================================
%Here is the data for 'plmc100d.m'
%======================================================================
Dtvals = [2^-9, 2^-8, 2^-7, 2^-6, 2^-5];
%======================================================================

%error1: indicator function
%======================================================================
%seed=100  [0.00400000000000000,0.0100000000000000,0.0460000000000000,0.180000000000000,0.602000000000000]
%seed=200 [0.00400000000000000,0.0140000000000000,0.0400000000000000,0.160000000000000,0.594000000000000]
%seed=300 [0.00600000000000000,0.0100000000000000,0.0320000000000000,0.138000000000000,0.614000000000000]
%seed=800 [0.00200000000000000,0.0140000000000000,0.0380000000000000,0.152000000000000,0.604000000000000]
%seed=700 [0.00800000000000000,0.0200000000000000,0.0440000000000000,0.154000000000000,0.586000000000000]
%seed=1500 [0.0100000000000000,0.0100000000000000,0.0200000000000000,0.128000000000000,0.522000000000000]
error1=[0.005666666666667   0.013000000000000   0.036666666666667   0.152000000000000   0.587000000000000];


%======================================================================
%error2: \exp function
%======================================================================
%seed=100 [0.000520966859162285,0.00167842743058722,0.00394769308640847,0.00954259083646785,0.0260328398943470];
%seed=200 [0.000530799456021110,0.00165941037965722,0.00391392958993185,0.00933974332796589,0.0266090893147312]
%seed=300 [0.000530109813327496,0.00166952878708518,0.00407650283097801,0.00946816519733195,0.0267883822504218]
%seed=800 [0.000510151783318877,0.00154379562061491,0.00385754980823961,0.00926416532491953,0.0264002245935811]
%seed=700 [0.000553336316260916,0.00168233330710365,0.00396746303864552,0.00912198150209962,0.0269259926390400]
%seed=1500 [0.000548446370500433,0.00169459367152362,0.00380797339692979,0.00929017991270336,0.0258243757331172]
error2=[0.000532301766432   0.001654681532762   0.003928518625189   0.009337804350248   0.026430150737540];
%测试函数为指数函数
%seed=100 [0.00300000000000000,0.00750000000000000,0.0375000000000000,0.133000000000000,0.455500000000000];
%seed=200 [0.00100000000000000,0.00950000000000000,0.0280000000000000,0.118000000000000,0.455500000000000]
%seed=300 [0.00450000000000000,0.00750000000000000,0.0210000000000000,0.100500000000000,0.460000000000000]
%seed=800 [0.00150000000000000,0.00950000000000000,0.0275000000000000,0.114000000000000,0.460000000000000]
%seed=700 [0.00700000000000000,0.0150000000000000,0.0320000000000000,0.115500000000000,0.447000000000000]
%seed=1500 [0.00750000000000000,0.00650000000000000,0.0120000000000000,0.0900000000000000,0.391500000000000]
error3= [0.004083333333333   0.009250000000000   0.026333333333333   0.111833333333333   0.444916666666667];
%测试函数为阶梯函数
%seed=100 [0.000828924213991337,0.00267219111163280,0.00631869252422576,0.0153939132958253,0.0430297705537036];
%seed=200 [0.000845184355716816,0.00264208024111465,0.00625392718360636,0.0150546475132226,0.0439498775687407]
%seed=300 [0.000841485094329148,0.00264996223477405,0.00649089355347978,0.0152294415520688,0.0441940658698151]
%seed=800 [0.000811176035453675,0.00245461776768351,0.00615131016503326,0.0149142973636084,0.0434695267584846]
%seed=700 [0.000879524644235981,0.00267197903195274,0.00632466338348076,0.0146707644122185,0.0443494011446080]
%seed=1500 [0.000871509338551134,0.00268765703313314,0.00605503989409165,0.0148914906869351,0.0424497129846887]
error4=[0.000846300613713   0.002629747903382   0.006265754450653   0.015025759137313   0.043573725813340];
%测试函数为atan函数

loglog(Dtvals,error1,'b-^','LineWidth' ,1.5 , 'MarkerSize',5);
hold on;
loglog(Dtvals,error2,'g-o','LineWidth' ,1.5 , 'MarkerSize',5);
hold on;
loglog(Dtvals,error3,'c-p','LineWidth' ,1.5 , 'MarkerSize',5);
hold on;
loglog(Dtvals,error4,'m-d','LineWidth' ,1.5 , 'MarkerSize',5);
hold on;
loglog(Dtvals,0.08*(Dtvals),'r-.h','LineWidth' ,1.5);
hold on;
loglog(Dtvals,9.5*(sqrt(Dtvals)),'k-+','LineWidth' ,1.5);
hold on;
axis([1e-3 1e-1 1e-5 1e1]);
legend('\phi(x)=indicator function', '\phi(x)=exp(-||x||)','\phi(x)=ladder function','\phi(x)=arctan(||x||)','order 1.0','order 0.5', 'location','SouthEast');
xlabel('Stepsizes')
ylabel('Weak errors')
title('Weak convergence rate of the projected Langevin Monte Carlo algorithm (d=100)','FontSize',10);